#include "cnn_model.h"

CNN_WEIGHTS_DTYPE CNN_weights[CNN_KERNEL_LENGTH][CNN_KERNEL_DEPTH][CNN_KERNEL_COUNT] = {
-0.053756397, 0.085901365, 0.060897186, -0.14586923, 0.10654191, -0.038143877, -0.05716319, 0.15696117, 0.1455551, 0.027472464,
-0.10086827, -0.099752426, -0.12844129, 0.017547563, 0.041626986, 0.0055659544, 0.007298263, -0.0932603, -0.024505934, 0.00965466,
0.03260213, -0.076455005, -0.11699427, 0.15259883, -0.022801321, -0.021722171, 0.10407507, 0.06970177, -0.014870183, 0.08852052,
0.05136457, 0.07959793, 0.008211327, -0.13079779, 0.05047283, 0.16085617, 0.1055904, 0.078284584, 0.16421248, -0.13741586,
0.14363292, 0.04347211, -0.046137936, -0.14669162, 0.13022676, -0.050846763, 0.07017098, 0.11777076, 0.009193745, 0.10728734,
-0.03714464, -0.08119474, 0.09237547, -0.026665496, 0.11805152, -0.0906634, 0.05101489, -0.09506504, -0.014432216, 0.046092153,
0.10564939, -0.045332074, -0.07332999, -0.08724518, 0.09852301, 0.10263092, 0.007239313, 0.05896492, -0.061834328, -0.06423012,
0.11139265, 0.057063933, -0.123264305, -0.004989821, 0.08043179, 0.14726306, 0.15154901, 0.02530645, -0.07466796, -0.02185192,
-0.09459152, -0.008279249, 0.03824393, -0.073965214, -0.007877481, 0.094746545, 0.14392331, 0.15484606, -0.11056907, 0.13880993,
0.053940307, 0.15897371, 0.14570694, -0.10245904, -0.07338478, 0.09830645, 0.06671925, 0.0076059275, -0.07335726, 0.10136732,
0.14217542, 0.013555069, 0.005022888, -0.049298145, 0.008818221, -0.15202491, 0.02562297, 0.031355727, -0.06324844, 0.12513797,
-0.10471221, -0.10800425, -0.10208485, 0.14304444, 0.06438213, 0.020077804, -0.14502327, 0.08748712, -0.045249946, -0.051724385,
0.06582893, -0.109502025, -0.1551593, -0.013213143, -0.11705533, -0.031560667, 0.033696324, -0.0014807839, -0.09053675, -0.1258345,
0.12778734, -0.08798495, -0.038073897, 0.15344742, -0.0010733975, -0.11707658, -0.107714616, 0.1326157, -0.08263924, -0.04008769,
0.07964864, -0.016574828, -0.17364769, 0.121842414, 0.112978846, 0.1092132, 0.1549277, 0.14985374, 0.14471912, -0.10132225,
-0.000193743, 0.1052858, 0.09915103, -0.15079236, -0.14621878, 0.057136007, -0.06220402, -0.114737675, -0.04289145, -0.14887886,
0.049347837, -0.117092885, 0.06895894, 0.14154887, -0.05367754, -0.025028272, -0.07520229, -0.034041427, 0.06530826, 0.08861797,
-0.024056673, 0.012976615, -0.085959874, 0.0052754246, 0.13514523, -0.008894678, 0.050530452, 0.05856175, 0.1453689, -0.019872585,
0.1213774, 0.103894114, -0.071348645, 0.13265795, -0.07496921, -0.0678861, -0.13576923, 0.09692553, 0.10156813, 0.015412561,
-0.11152354, 0.031664032, 0.0728472, 0.03661455, -0.06030443, 0.122572504, -0.055268854, 0.08058238, -0.05864046, -0.0077455486,
0.00042591573, -0.122585945, -0.048067816, 0.05404104, -0.099100426, -0.06979255, -0.033139758, 0.02261651, 0.045881346, -0.0916018,
0.002534202, -0.13538925, -0.15377103, -0.03689744, 0.09473292, -0.13928966, 0.14285436, 0.012303473, -0.024213033, -0.038150944,
-0.13647254, 0.14607058, 0.020093827, -0.08188221, 0.0618363, 0.094181255, 0.13190033, 0.112401344, 0.026301935, -0.11577721,
0.015357366, -0.051181663, -0.08871878, 0.050545897, 0.054236356, -0.14511776, 0.005504559, 0.059513256, -0.04937615, -0.048704945,
-0.046334304, 0.057441, -0.108367085, -0.015918154, 0.10427792, -0.014253008, -0.012916664, 0.017042523, -0.14254257, 0.08784329,
-0.09298555, -0.044665027, -0.07674725, -0.13316885, 0.09875496, -0.0262156, 0.10397435, -0.10491041, -0.030054444, 0.012048908,
-0.094787054, 0.029504424, 0.0074730134, -0.112480685, 0.113477275, -0.033082407, -0.042373277, 0.16101551, -0.0039663236, 0.0037918575,
0.10012631, -0.08072611, 0.07203828, -0.15429983, 0.005232424, 0.15448613, -0.058990072, -0.13403517, -0.05111472, 0.042943947,
0.094726786, 0.052032933, 0.031520624, -0.018849568, 0.10194496, 0.069175735, 0.0010935058, -0.007347018, 0.11244433, -0.007534681,
0.04615155, -0.08744999, -0.020999724, 0.103832796, -0.04300849, -0.114864476, -0.07640343, 0.033564646, -0.023642842, -0.020779751,
0.0410167, -0.01491083, -0.063630186, -0.12994915, 0.03717904, -0.10723426, 0.05210232, 0.068537235, 0.11059844, 0.13043353,
0.054991383, -0.11177754, -0.15302654, 0.028171271, 0.027094474, -0.06812214, -0.028732557, 0.1470165, 0.15298298, 0.10625131,
0.13395467, -0.021125115, -0.027809814, -0.07789996, 0.04192017, 0.15148601, 0.16736442, -0.061917264, 0.012451212, 0.048645705,
-0.1433537, -0.13877986, 0.04129539, 0.017308861, 0.12219073, -0.010721683, -0.14499621, 0.02741047, -0.1230519, -0.14164127,
-0.129014, -0.07320646, -0.1201393, -0.1267294, 0.029878741, -0.037979234, -0.07304633, 0.06991846, 0.00594577, -0.14092767,
0.1339622, -0.046846744, -0.028496489, 0.12385047, 0.15225595, -0.1597979, 0.084439546, -0.04070183, 0.115988605, 0.1046416,
0.08866621, -0.11148262, 0.09261857, 0.022296827, -0.082523726, 0.07960966, -0.12002186, -0.004171804, -0.047985666, 0.12815344,
0.066732645, 0.12613559, -0.14103664, -0.16352384, 0.067556635, 0.051759016, 0.041221887, 0.0152815655, 0.081732556, -0.08889851,
-0.06873353, -0.043413993, -0.03511843, -0.103869766, 0.015692243, 0.17151532, -0.084500335, -0.08645363, -0.053622484, 0.039202314,
0.14190783, -0.015429628, 0.09843472, 0.0036458208, 0.14032522, 0.055855025, -0.09595709, 0.1401141, -0.018688947, -0.09550267,
0.06413623, 0.06722035, 0.13092034, 0.12223111, -0.08466074, -0.016163267, 0.07655507, 0.08012709, 0.07551625, 0.08666011,
0.12364393, 0.10728652, 0.035944413, -0.15385792, 0.057283457, 0.012334241, 0.048820443, -0.022629581, -0.029119428, -0.07097646,
0.084584825, -0.0050607556, 0.018366253, 0.039666, 0.11499161, 0.13465773, 0.13158862, 0.13116047, -0.091616794, 0.053517673,
-0.09133099, -0.038122095, -0.15525708, 0.056994956, 0.0827582, 0.14125049, -0.08426638, 0.056220848, -0.110657014, -0.09005353,
0.16786437, 0.050257538, -0.12024771, 0.14521152, 0.06547968, 0.13074642, -0.077711634, -0.037056923, -0.08761868, 0.09387825,
-0.097772, 0.15109903, 0.027720304, 0.03154849, 0.10801501, -0.015088804, -0.08651958, 0.009605639, 0.16739391, -0.050891414,
0.1563019, 0.003860601, -0.059883237, 0.123727925, -0.015929837, 0.012876929, 0.01098696, 0.06306325, 0.03161319, 0.074140966,
-0.14788605, 0.08666258, 0.028638905, 0.13029644, -0.008697671, 0.047642797, -0.11774347, 0.111803696, -0.05106522, 0.07087887,
-0.13033639, 0.0961124, 0.13732399, -0.13173112, -0.13048829, 0.08495871, 0.12395842, -0.06978214, 0.028201073, -0.11220193,
-0.11375917, 0.013023638, 0.03279381, -0.07077799, -0.08050346, 0.024246344, -0.030279351, -0.03757492, 0.16161028, 0.004892521,
0.1494313, 0.10542529, 0.064754814, 0.028577358, 0.033908293, 0.06913141, -0.1110194, 0.044560447, -0.06638018, 0.09648055,
-0.11817154, 0.09092993, 0.114063576, -0.14079662, -0.07786367, -0.082797535, 0.013858603, 0.03136437, 0.16167854, -0.13101159,
0.06367349, 0.12562516, -0.049255565, -0.08235578, 0.07236658, 0.06042824, 0.14363927, -0.07070246, -0.129742, -0.10859553,
-0.07427617, 0.029087136, 0.01911777, -0.114784464, 0.066702284, -0.13726811, 0.01500388, 0.16394337, -0.16105159, -0.13515668,
0.098264575, 0.12450235, 0.11392023, 0.12565137, 0.14896455, 0.11036178, -0.14419204, -0.111050524, 0.08668194, -0.07913755,
0.083289474, -0.06361304, 0.114092834, -0.037410464, 0.10390203, -0.14136674, 0.09949962, -0.09655766, -0.09805007, 0.14003074,
0.015423217, -0.11365301, 0.11378718, 0.020607948, -0.027843956, -0.017782792, 0.07449315, 0.11167767, -0.12173733, -0.06625314,
-0.04471945, 0.02359848, -0.13473256, -0.0322595, 0.015744409, -0.10899638, -0.09810199, -0.046601012, -0.1364384, 0.09548062,
-0.099535994, 0.10770946, -0.09174794, -0.08802793, 0.12544082, 0.040986653, 0.14286657, 0.07979119, 0.11431163, 0.053001236,
-0.021915592, 0.053927932, 0.062439326, 0.051461197, 0.05935766, -0.11925684, 0.003834007, 0.016575428, 0.021851936, 0.09888225,
-0.088461325, -0.0034411147, -0.13436967, -0.022812033, -0.08939267, -0.02195815, 0.05510263, 0.14276041, -0.0009929173, -0.13198443,
-0.14587554, 0.07442097, -0.07531921, -0.078276955, -0.0634671, -0.15009388, 0.009341392, 0.068674594, 0.1390112, -0.08894137,
-0.13870549, 0.058852173, -0.12102436, 0.128398, -0.039028794, 0.06250184, -0.10238281, 0.13474172, -0.076373756, -0.12558587,
-0.09600941, 0.030228784, -0.038371038, -0.028282017, 0.14632402, -0.1109236, -0.047026046, 0.0027989266, 0.114164434, -0.09200471,
-0.14597847, 0.06048109, 0.05613197, 0.00044205546, -0.14722808, 0.058045875, -0.14058566, 0.08901088, 0.14270592, -0.09465992,
0.09730819, 0.13572891, -0.11539658, -0.02834635, 0.06745451, -0.0033268868, -0.09238715, -0.098852195, -0.1604723, -0.087578304,
-0.036295034, 0.118057266, 0.123121396, -0.025917664, 0.15617119, 0.13367975, 0.16242567, 0.06308936, 0.07489088, -0.024049759,
0.08791958, -0.139524, -0.08553942, -0.1382758, -0.06230442, 0.1323124, -0.10480016, -0.082121015, -0.09876535, -0.05332588,
-0.07408795, -0.13521573, -0.078966215, 0.08129016, -0.07047681, -0.109014496, 0.09528691, 0.13036664, 0.08449569, -0.07322849,
-0.07476588, -0.037338935, -0.06977487, -0.15234435, -0.13001123, -0.002330765, 0.11232065, -0.012839998, 0.008201325, -0.08375904,
-0.14320385, -0.008232679, -0.09105484, -0.12282815, -0.00064433826, -0.10662967, -0.06655085, 0.05775764, -0.14408639, 0.037374806,
-0.13801663, 0.12472251, 0.058202542, -0.03653985, 0.024239996, 0.12309833, 0.026456213, 0.08513036, 0.036426138, -0.006232089,
0.012276352, 0.123334065, 0.038421184, -0.10820101, 0.097473904, -0.032037307, -0.11763532, -0.010621498, 0.022598473, 0.0029428992,
4.8074035e-05, -0.0045992774, 0.1199533, -0.019059192, 0.0941374, -0.064401224, -0.03360843, 0.058915462, -0.021392142, -0.0051476452,
0.13118537, 0.013893649, -0.10295922, 0.07871566, -0.035213523, -0.0041776705, 0.07164615, 0.115583226, 0.10232887, -0.11067517,
-0.035866234, 0.05774508, -0.07385268, 0.1091508, -0.036213096, -0.09159154, -0.011077523, -0.048673533, 0.045335606, 0.032049723,
-0.09281446, 0.007169715, 0.13737461, 0.14140806, 0.13872191, -0.14717197, 0.0009402832, -0.08727678, -0.104347065, 0.05461366,
0.08743604, 0.007459857, 0.02400753, 0.048013642, -0.1041159, 0.13819797, 0.022178037, 0.15033366, 0.11221792, -0.1444701,
-0.15042031, -0.056556556, 0.09240872, 0.053433917, -0.1289558, 0.09379211, -0.093077466, -0.11680908, 0.08121136, 0.10900636,
0.009589833, 0.12878114, 0.022606013, 0.010468632, -0.11070522, 0.10465919, -0.05467674, 0.1517467, 0.05986999, 0.12891626,
-0.07842515, 0.14874807, 0.079632394, 0.10037374, -0.086341605, -0.04285262, 0.0019574892, -0.08950775, 0.08293662, -0.06437956,
0.120123975, 0.014075768, -0.11874416, 0.12362019, -0.1299198, -0.02257052, 0.13925718, 0.11765383, -0.0632073, 0.16081539,
-0.04436142, 0.021871336, 0.03722848, 0.15964948, 0.08300568, -0.07471012, -0.036066514, 0.042753965, 0.044000495, 0.11652004,
0.1500153, 0.0905821, 0.09099714, 0.11118691, -0.08884871, -0.011923872, 0.046217464, -0.072600745, 0.1279638, 0.016831694,
0.082508236, -0.026150722, -0.12023385, -0.13781661, 0.07298271, 0.1376431, 0.1236049, 0.0828811, -0.12220115, -0.053370565,
-0.116845034, 0.15474656, -0.12805589, -0.026508654, 0.00912504, 0.12581664, 0.089819536, -0.13656771, 0.0036345285, -0.05662298,
0.03822961, 0.0065145306, 0.058852684, 0.08847224, 0.07745628, -0.033415105, -0.10551706, 0.12099651, 0.043181866, -0.015529832,
0.11092997, -0.13425933, -0.11110786, -0.057256047, -0.14521879, 0.06587331, 0.043328397, -0.044970144, 0.094747834, 0.11556772,
0.082656555, -0.01039626, -0.061193794, -0.090787955, 0.1455045, -0.13982509, 0.06123339, 0.09656337, -0.13261522, 0.02466866,
0.09217153, 0.004570782, 0.08839678, -0.093059495, -0.101106204, 0.023294942, -0.12551515, -0.08609102, -0.083404176, 0.07239915
};
CNN_BIAS_DTYPE CNN_bias[CNN_KERNEL_COUNT] = {
-0.006093029, -0.017818183, 0.014397823, -0.0015420072, -0.019331288, 0.0014155284, -0.008047266, -0.016004855, -0.016303021, -0.011869616
};
DENSE_WEIGHTS_DTYPE dense_weights[DENSE_OUTPUT_NODES][DENSE_INPUT_NODES] = {
-0.08604098, 0.14442517, 0.07380174, -0.21889155, 0.13814698, -0.061569907, -0.10269723, 0.22849397, 0.1761734, 0.01031598,
-0.13238674, -0.16158916, -0.14143759, 0.012936375, 0.0155854495, 2.8120057e-05, -0.0070993267, -0.14604354, -0.051283453, 0.0038946227,
0.011977664, -0.12136928, -0.12628575, 0.20182346, -0.04686187, -0.037492886, 0.101981245, 0.06813625, -0.02743572, 0.107565895,
0.066966824, 0.106574155, 0.018857207, -0.1622675, 0.07768285, 0.19356364, 0.11900883, 0.10249098, 0.1804402, -0.21371786,
0.20606416, 0.04485647, -0.060141213, -0.20373419, 0.16366453, -0.06367422, 0.12233008, 0.18438517, 0.041597076, 0.11933381,
-0.04260841, -0.12214529, 0.0980842, -0.029535562, 0.14726263, -0.11053066, 0.044816736, -0.15401614, -0.0050346213, 0.028825207,
0.1264021, -0.043706134, -0.09263913, -0.14059171, 0.12583433, 0.12828025, -0.018654883, 0.09777992, -0.09092894, -0.10457512,
0.14495412, 0.0534696, -0.13968277, 0.0018622096, 0.06595988, 0.18051447, 0.18860425, 0.02763098, -0.10842156, -0.04956288,
-0.15566847, -0.037335213, 0.07536025, -0.092906, -0.022608547, 0.110254444, 0.15465067, 0.1796656, -0.15383027, 0.17076933,
0.08182125, 0.20386514, 0.21296273, -0.13345216, -0.08346074, 0.11083894, 0.076337926, 0.009746041, -0.13401426, 0.10494138,
0.19348055, 0.025438199, -0.021122402, -0.066607974, 0.0011356105, -0.19560908, 0.051521536, 0.07258323, -0.054348618, 0.14325328,
-0.13597415, -0.17371243, -0.14672913, 0.18702106, 0.06794906, 0.035550382, -0.21765204, 0.08952835, -0.04521207, -0.10051063,
0.07297872, -0.11168098, -0.2120614, -0.04188609, -0.16158845, -0.051921073, 0.030397661, 0.009916176, -0.13756979, -0.19215792,
0.16814849, -0.13621299, -0.038057063, 0.2174335, -0.04036703, -0.15427709, -0.1726267, 0.16398865, -0.12718824, -0.05184143,
0.07336387, -0.054939605, -0.19855621, 0.16959064, 0.13934764, 0.13761924, 0.16590443, 0.17430851, 0.18563884, -0.14779745,
-0.007355694, 0.1463909, 0.13069224, -0.19772868, -0.18502401, 0.053343847, -0.07103941, -0.15577714, -0.1043444, -0.22788987,
0.06529202, -0.14439291, 0.061315645, 0.18734968, -0.07857325, -0.0016285112, -0.09741185, -0.02416522, 0.10931009, 0.10745991,
-0.03747406, -0.014423611, -0.11996707, 0.012504071, 0.15172157, 0.0024945752, 0.042357218, 0.05001957, 0.21235289, -0.05370189,
0.14036335, 0.18175201, -0.10404366, 0.15592963, -0.10475471, -0.10404389, -0.17991935, 0.13940893, 0.115715526, -0.0054676654,
-0.14099984, 0.0022898472, 0.10485603, 0.062699534, -0.10987752, 0.1710828, -0.10816382, 0.096412554, -0.09922459, -0.0130426595,
-0.03200312, -0.19875391, -0.028563244, 0.08279621, -0.1632065, -0.10290549, -0.08667155, 0.0021869964, 0.055807136, -0.13663001,
0.0049251206, -0.17572692, -0.19948693, -0.042238474, 0.11795494, -0.1807798, 0.18674377, 0.014073493, -0.06392877, -0.080320664,
-0.18816571, 0.20158248, -0.002532177, -0.11045122, 0.080846675, 0.16297515, 0.17876521, 0.16770136, 0.058075678, -0.16454901,
0.012636445, -0.102115095, -0.12706695, 0.07975948, 0.039798006, -0.17688118, -0.018176923, 0.04596232, -0.04265903, -0.09376581,
-0.07638415, 0.11139684, -0.15288642, -0.031614427, 0.11811431, -0.01623334, -0.02643516, 0.031002577, -0.20553257, 0.092942245,
-0.115010574, -0.08718521, -0.097140074, -0.15681326, 0.092075475, -0.013544998, 0.10480773, -0.16568774, -0.063060224, 0.012982851,
-0.15796386, 0.007069896, 0.015956566, -0.12354018, 0.12209378, -0.050724827, -0.10014199, 0.1820231, -0.009076108, -0.009468707,
0.14144506, -0.10591772, 0.10128457, -0.18484633, 0.018999945, 0.18547088, -0.071122326, -0.17939569, -0.111238375, 0.027356751,
0.12158969, 0.080910996, 0.01139218, -0.03418816, 0.15036221, 0.12848428, 0.008949294, -0.0051172636, 0.17572531, -0.018899161,
0.0653039, -0.13094002, -0.047087785, 0.15001035, -0.09312988, -0.13106187, -0.12773588, 0.012008426, -0.003147016, -0.056137674,
0.044743363, 0.0064244047, -0.081776, -0.1720994, 0.041247886, -0.15241317, 0.044614762, 0.11643254, 0.12421367, 0.15666114,
0.06800764, -0.16595504, -0.19537173, 0.046490666, 0.018920876, -0.06987875, -0.058306683, 0.15657236, 0.17960341, 0.14690766,
0.14986637, -0.046474207, -0.026687445, -0.09164782, 0.01893507, 0.19416681, 0.19511716, -0.11526838, 0.013317144, 0.045060508,
-0.1709838, -0.19207782, 0.062611915, 0.031191718, 0.1854334, -0.027448175, -0.19524303, 0.03889331, -0.20630379, -0.22550832,
-0.17672467, -0.087273, -0.18969834, -0.18123788, 0.042027142, -0.014822912, -0.08380376, 0.09689998, 0.02560395, -0.1942375,
0.17238748, -0.06509059, -0.055852607, 0.17154911, 0.16757439, -0.18814805, 0.0862117, -0.08993142, 0.18826944, 0.11441644,
0.11004719, -0.12246764, 0.13003498, 0.015878655, -0.108412206, 0.08921369, -0.19119571, 0.01550824, -0.08819382, 0.15353891,
0.070285425, 0.16062643, -0.17109579, -0.19933707, 0.05545819, 0.092731774, 0.028201777, -0.016587425, 0.087804645, -0.111680925,
-0.11980926, -0.07360908, -0.040826704, -0.12316697, -0.019158892, 0.22492997, -0.14831762, -0.14755315, -0.07659091, 0.031704254
};
DENSE_BIAS_DTYPE dense_bias[DENSE_OUTPUT_NODES] = {
-0.0064899325, 0.0193898, -0.019164648
};

CNN_IN_DTYPE input_buffer[CNN_KERNEL_LENGTH][INPUT_DEPTH];
CNN_OUT_DTYPE cnn_output_buffer[CNN_OUTPUT_LENGTH][CNN_OUTPUT_DEPTH];
DENSE_OUTPUT_DTYPE dense_output[DENSE_OUTPUT_NODES];

void top_function(
		FUNCTION_SELECT_BIT_WIDTH function_select,
		CNN_RAW_IN_DTYPE data_in[CNN_KERNEL_LENGTH][INPUT_DEPTH],
		float result_out[DENSE_OUTPUT_NODES]) {
#pragma HLS interface s_axilite port=return bundle=control
#pragma HLS interface s_axilite port=function_select bundle=control
#pragma HLS interface axis port=data_in
#pragma HLS interface axis port=result_out


#pragma HLS ARRAY_PARTITION variable=CNN_weights type=cyclic dim=3 complete
#pragma HLS ARRAY_PARTITION variable=CNN_bias type=complete
#pragma HLS ARRAY_PARTITION variable=dense_weights type=cyclic dim=2 complete
#pragma HLS ARRAY_PARTITION variable=dense_bias type=complete
#pragma HLS ARRAY_PARTITION variable=input_buffer type=cyclic dim=2 complete
#pragma HLS ARRAY_PARTITION variable=cnn_output_buffer type=cyclic dim=2 complete
#pragma HLS ARRAY_PARTITION variable=dense_output type=complete

	static int CNN_output_count = 0;

	if (function_select == 0) {
		// input more data
		copy(&data_in[0][0], &input_buffer[0][0], CNN_KERNEL_LENGTH * INPUT_DEPTH);
		compute_convolution(input_buffer, CNN_weights, CNN_bias, cnn_output_buffer);
		CNN_output_count = (CNN_output_count == CNN_OUTPUT_LENGTH - 1) ? CNN_output_count : CNN_output_count + 1;

		// when the CNN output count = dense input count, compute dense
		if (CNN_output_count == CNN_OUTPUT_LENGTH - 1) {
			compute_dense(cnn_output_buffer, dense_weights, dense_bias, dense_output);
		}

	} else if (function_select == 1) {
		// read result
		copy(dense_output, result_out, DENSE_OUTPUT_NODES);
	} else if (function_select == 2) {
		// reset CNN output buffer
		reset(cnn_output_buffer);
		// reset the CNN output count
		CNN_output_count = 0;
	}
}
